$(function() { $(".input,.login_input,.textarea").focus(function() { $(this).addClass("focus") }).blur(function() { $(this).removeClass("focus") }); $(".submit").mouseover(function() { $(this).addClass("submitFocus") }).mouseout(function() { $(this).removeClass("submitFocus") }); $("[HintTitle],[HintInfo]").focus(function(event) { $("*").stop(); $("#HintMsg").remove(); var HintHtml = "<ul id=\"HintMsg\"><li class=\"HintTop\"></li><li class=\"HintInfo\"><b>" + $(this).attr("HintTitle") + "</b>" + $(this).attr("HintInfo") + "</li><li class=\"HintFooter\"></li></ul>"; var offset = $(this).offset(); $("body").append(HintHtml); $("#HintMsg").fadeTo(0, 0.85); var HintHeight = $("#HintMsg").height(); $("#HintMsg").css({ "top": offset.top - HintHeight + "px", "left": offset.left + "px" }).fadeIn(500) }).blur(function(event) { $("#HintMsg").remove() }); $(".svaPoint,.svaAmount,.svaQty").bind("keyup", function() { $(this).val(formatNumber($(this).val())) }); $(".svaCode").bind("keyup", function() { $(this).val($(this).val().toUpperCase()) }); $(".svaCode").addClass("inputUpper"); $(".svaCode").keypress(function(event) { var keyCode = event.which; if ((keyCode >= 65 && keyCode <= 90) || (keyCode >= 97 && keyCode <= 122) || (keyCode >= 48 && keyCode <= 57)) return true; else return false }).focus(function() { this.style.imeMode = 'disabled' }); $(".NumMaskValid").keypress(function(event) { var keyCode = event.which; if (keyCode == 65 || (keyCode == 57) || (keyCode == 97)) return true; else return false }).focus(function() { this.style.imeMode = 'disabled' }); if (jQuery != undefined && jQuery.validator != undefined) { jQuery.validator.addMethod("svaAmount", function(value, element) { if (value == null || value.length <= 0) return true; var reg = /^(\d{1,2},){0,1}(\d{1,3},){0,1}\d{1,3}(\.\d{1,2})?$/gi; return reg.exec(value) }, jQuery.validator.messages.SvaAmount); jQuery.validator.addMethod("svaPoint", function(value, element) { if (value == null || value.length <= 0) return true; var reg = /^(\d{1,2},){0,1}(\d{1,3},){0,1}\d{1,3}$/gi; return reg.exec(value) }, jQuery.validator.messages.SvaPoint); jQuery.validator.addMethod("svaDiscount", function(value, element) { if (value == null || value.length <= 0) return true; var reg = /^(100|\d{1,2})$/gi; return reg.exec(value) }, jQuery.validator.messages.SvaDiscount); jQuery.validator.addMethod("svaQty", function(value, element) { var reg = /^(\d{1,2},){0,1}\d{1,3}$/gi; return reg.exec(value) }, jQuery.validator.messages.SvaQty); jQuery.validator.addMethod("NumMaskValid", function(value, element) { if (value == null || value.length <= 0) return true; var reg = /^A+9+$/gi; return reg.exec(value) }, jQuery.validator.messages.NumMaskValid); jQuery.validator.addMethod("NumPatternValid", function(value, element) { var reg = /^A+/gi; var mask = $(".NumMaskValid").val(); if (mask.length <= 0) return true; var result = reg.exec(mask); if (result == null || result.length <= 0) return true; return result.toString().length == value.length }, jQuery.validator.messages.CardNumPatternValid); jQuery.validator.addMethod("svaCode", function(value, element) { if (value == null || value.length <= 0) return true; var reg = /^[A-Z0-9]+$/gi; return reg.exec(value) }, jQuery.validator.messages.SvaCode) } }); function tabs(tabNum) { $("#tabs ul li").removeClass("hover"); $("#tabs ul li").eq(tabNum - 1).addClass("hover"); $(".fragment").hide(); $(".fragment").eq(tabNum - 1).show() } function checkAll(chkobj) { if ($(chkobj).attr("checked") == true) { $(".checkall input").attr("checked", true); $(".checkall input[disabled=disabled]").attr("checked", false) } else { $(".checkall input").attr("checked", false) } } function SingleUpload(repath, hideValue, uppath, savefilesubpath, submitUrl) { submitUrl = submitUrl + "?ReFilePath=" + repath + "&UpFilePath=" + uppath + "&SaveFileSubPath=" + savefilesubpath; $("#form1").ajaxSubmit({ beforeSubmit: function(formData, jqForm, options) { $("#" + repath).nextAll(".files").eq(0).hide(); $("#" + repath).nextAll(".uploading").eq(0).show() }, success: function(data, textStatus) { if (data.msg == 1) { $("#" + repath).val(data.msbox); $("#" + hideValue).val(data.msbox) } else { alert(data.msbox) } $("#" + repath).nextAll(".files").eq(0).show(); $("#" + repath).nextAll(".uploading").eq(0).hide() }, error: function(data, status, e) { alert("上传失败，错误信息：" + e); $("#" + repath).nextAll(".files").eq(0).show(); $("#" + repath).nextAll(".uploading").eq(0).hide() }, url: submitUrl, type: "post", dataType: "json", timeout: 600000 }) }; function checkUrl(link) { var textboxs = $(link).parent().children("input"); if (textboxs.length > 0) { var regUrl = /\?Url=[^&]*/gi; link.href = link.href.replace(regUrl, "?Url=" + textboxs[0].value) } } function formatNumber(num) { if (!num || num.length <= 0) return ""; var strNum = num.replace(/,/g, ""); var reg = /\.\w+/g; var amount = reg.exec(strNum); if (amount != null) { strNum = strNum.replace(reg, "") } var result = ""; for (i = strNum.length - 1; i >= 0; i--) { if ((i - 2) % 3 == 0) result += ","; result += strNum[strNum.length - i - 1] } if (result[0] == ",") result = result.substring(1, result.length); if (amount != null) return result + amount; return result }